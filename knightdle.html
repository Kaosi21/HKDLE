<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Guess the Character - Hollow Knight</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom right, #0f2027, #203a43, #2c5364);
      color: white;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    input[type="text"] {
      padding: 10px;
      width: 100%;
      max-width: 400px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
    }

    button {
      padding: 10px 15px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
      margin-top: 10px;
    }

    .suggestions-list {
      background-color: #333;
      border: 1px solid #666;
      max-height: 200px;
      overflow-y: auto;
      border-radius: 5px;
      position: absolute;
      width: 100%;
      z-index: 10;
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      padding: 8px;
      cursor: pointer;
      color: white;
    }

    .suggestion-item:hover {
      background-color: #444;
    }

    .suggestion-item img {
      width: 40px;
      height: 40px;
      border-radius: 4px;
      margin-right: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      overflow: hidden;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #222;
      font-weight: bold;
    }

    .match {
      background-color: #8BC34A;
      color: #000;
    }

    .partial {
      background-color: #FFEB3B;
      color: #000;
    }

    .wrong {
      background-color: #E57373;
      color: #000;
    }

    img.character-img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 50%;
    }

    #win-screen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.9);
      color: white;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 999;
    }

    #win-screen.active {
      display: flex;
    }

    .winner-img {
      width: 200px;
      border-radius: 12px;
      margin-top: 20px;
      animation: celebrate 1s ease-out forwards;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
    }

    @keyframes celebrate {
      0% { transform: scale(0.8); opacity: 0; }
      50% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); }
    }

    .autocomplete-wrapper {
      position: relative;
      max-width: 400px;
      margin: 0 auto;
    }

    @keyframes fadeSlideIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes lightBurst {
  0% {
    background-color: rgba(0, 0, 0, 0.9);
  }
  50% {
    background-color: rgba(255, 255, 255, 0.3);
  }
  100% {
    background-color: rgba(0, 0, 0, 0.9);
  }
}

@keyframes bounceIn {
  0% {
    transform: scale(0.3);
    opacity: 0;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    transform: scale(1);
  }
}

/* Applichiamo le animazioni quando servono */
.win-animate {
  animation: lightBurst 1s ease-out;
}

.winner-img {
  animation: bounceIn 1s ease-out forwards;
}

.fade-slide-row {
  animation: fadeSlideIn 0.6s ease-out;
}
.particle {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  opacity: 0.8;
  z-index: 2000;
  pointer-events: none;
  animation: explode 1s ease-out forwards;
}

@keyframes explode {
  0% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(var(--x), var(--y)) scale(0.5);
    opacity: 0;
  }
}

  </style>
</head>
<body>

<h1>Guess the Character - Hollow Knight</h1>

<div class="autocomplete-wrapper">
  <input type="text" id="guess" placeholder="Type a Hollow Knight character..." oninput="showSuggestions()" autocomplete="off">
  <div id="suggestions" class="suggestions-list"></div>
</div>

<div style="text-align:center;">
  <button onclick="checkGuess()">Submit</button>
</div>

<table id="feedback">
  <thead>
    <tr>
      <th>Image</th>
      <th>Name</th>
      <th>Region</th>
      <th>Alignment</th>
      <th>Species</th>
      <th>Weapon</th>
      <th>Gameplay</th>
      <th>Gender</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div id="win-screen">
  <h2>Hai indovinato!</h2>
  <img id="win-image" class="winner-img" src="" alt="Winner">
  <button onclick="location.reload()">Gioca di nuovo</button>
</div>

<script>
  const characters = [
    {
      name: "The knight",
      region: "The abyss",
      alignment: "Il bruchi",
      species: "Vessel",
      weapon: "Nail, Shadow, Cloak, Crystal",
      gameplay: "Character",
      gender: "Unknown",
      photo: "https://static.wikia.nocookie.net/hollowknight/images/9/94/Knight_godmaster.png/revision/latest?cb=20190620145901&path-prefix=it",
    },
    {
      name: "Hornet",
      region: "Greenpath",
      alignment: "Neutral",
      species: "Vessel",
      weapon: "Nail, String",
      gameplay: "Boss, NPC",
      gender: "Female",
      photo: "https://static.wikia.nocookie.net/hollowknight/images/8/89/B_Hornet.png/revision/latest?cb=20190910120637&path-prefix=it",
    },
    {
      name: "Radiance",
      region: "Dream realm",
      alignment: "Hostile",
      species: "God",
      weapon: "Light, Mental control, Teleport",
      gameplay: "Boss",
      gender: "Female",
      photo: "https://static.wikia.nocookie.net/hollowknight/images/d/d7/The_Radiance_Stagger_2.png/revision/latest?cb=20190314011114",
    }
  ];

  const target = characters[Math.floor(Math.random() * characters.length)];
  const usedCharacters = [];

  function getClass(guessVal, targetVal) {
    const normalize = str => str.toLowerCase().split(',').map(s => s.trim());
    const guessList = normalize(guessVal);
    const targetList = normalize(targetVal);
    const intersection = guessList.filter(val => targetList.includes(val));
    if (guessList.length === targetList.length && intersection.length === guessList.length) {
      return "match";
    } else if (intersection.length > 0) {
      return "partial";
    } else {
      return "wrong";
    }
  }

  function showSuggestions() {
    const input = document.getElementById("guess").value.toLowerCase();
    const suggestionsDiv = document.getElementById("suggestions");
    suggestionsDiv.innerHTML = "";

    if (input.length === 0) {
      suggestionsDiv.style.display = "none";
      return;
    }

    const filtered = characters
      .filter(c => !usedCharacters.includes(c.name.toLowerCase()))
      .filter(c => c.name.toLowerCase().includes(input));

    filtered.slice(0, 5).forEach((char) => {
      const item = document.createElement("div");
      item.className = "suggestion-item";
      item.innerHTML = `<img src="${char.photo}" alt="${char.name}"><span>${char.name}</span>`;
      item.onclick = () => {
        document.getElementById("guess").value = char.name;
        suggestionsDiv.innerHTML = "";
        suggestionsDiv.style.display = "none";
      };
      suggestionsDiv.appendChild(item);
    });

    suggestionsDiv.style.display = filtered.length > 0 ? "block" : "none";
  }

  function checkGuess() {
    const guessInput = document.getElementById("guess").value.toLowerCase();
    const guessedCharacter = characters.find(c => c.name.toLowerCase() === guessInput);
    if (!guessedCharacter) {
      alert("Character not found");
      return;
    }

    if (usedCharacters.includes(guessedCharacter.name.toLowerCase())) {
      alert("You already tried this character!");
      return;
    }

    usedCharacters.push(guessedCharacter.name.toLowerCase());

    const feedbackBody = document.querySelector("#feedback tbody");
    const row = document.createElement("tr");
    row.classList.add("fade-slide-row");


    const imgCell = document.createElement("td");
    imgCell.innerHTML = `<img class="character-img" src="${guessedCharacter.photo}" alt="${guessedCharacter.name}">`;
    row.appendChild(imgCell);

    const fields = ["name", "region", "alignment", "species", "weapon", "gameplay", "gender"];
    fields.forEach(attr => {
      const cell = document.createElement("td");
      const className = getClass(guessedCharacter[attr], target[attr]);
      cell.className = className;
      cell.textContent = guessedCharacter[attr];
      row.appendChild(cell);
    });

    feedbackBody.appendChild(row);

    if (guessedCharacter.name.toLowerCase() === target.name.toLowerCase()) {
      document.getElementById("win-screen").classList.add("active");
      document.getElementById("win-image").src = guessedCharacter.photo;
    }

    document.getElementById("guess").value = "";
  }
  function createParticles() {
  const colors = ["#ff4757", "#1e90ff", "#2ed573", "#ffa502", "#eccc68"];
  const numParticles = 80;

  for (let i = 0; i < numParticles; i++) {
    const particle = document.createElement("div");
    particle.classList.add("particle");
    particle.style.background = colors[Math.floor(Math.random() * colors.length)];

    const x = (Math.random() - 0.5) * 300 + "px";
    const y = (Math.random() - 0.5) * 300 + "px";
    particle.style.setProperty("--x", x);
    particle.style.setProperty("--y", y);

    particle.style.left = "50%";
    particle.style.top = "50%";

    document.body.appendChild(particle);

    setTimeout(() => {
      particle.remove();
    }, 1000);
  }
}

</script>

</body>
</html>
